​	

[TOC]

# 1 Linux 学习入门（Centos7）

## 1.1 杂知识

| C/S 架构                   | 服务器提供资源，客户机使用资源 |
| -------------------------- | ------------------------------ |
| TCP/IP                     | 点分十进制                     |
| Unix 诞生日期              | 1970年1月1日                   |
| 内核                       | 负责调配所有计算机物理硬件     |
| 版本号                     | 主：次：修订号                 |
| 常见系统                   | CentOS、Ubuntu                 |
| ifconfig                   | 不能查看网关                   |
| lo                         | 回环借口，127.0.0.1            |
| ifconfig eth0 192.1.1.1/24 | 临时设置ip                     |
| hostname                   | 查看主机名                     |
| hostname xxx               | 临时修改主机名                 |



## 1.2 文件系统

​	

| 系统    | 文件系统                                                     |
| ------- | ------------------------------------------------------------ |
| Windows | NTFS、FAT                                                    |
| Linux   | ext4（RHEL6） xfs（RHEL7）<br>swpa（虚拟内存，使用硬盘空间，设置后可增加10%-30%性能） |

```shell
# ext4：第四代扩展文件系统	xfs：高级日志文件系统
```



## 1.3 Linux目录结构

```shell
	# Linux 是树形结构目录，根目录是/
/	# 根目录，Linux系统的起点
```



### 1.3.1 磁盘与分区表示

- hd：IDE设备

- sd：SCSI设备

- vd：虚拟设备


​	第几块硬盘用a-z字母表示，第几个分区用数字表示		 

```shell
/dev/sdc3  # 第三块SCSI设备的第三个分区
```

```shell
uname -r # 查看内核版本  el7：企业版Linux7
cat /proc/meminfo # 查看内存信息
```



### 1.3.2 目录、文件及其内容

| 目录                | 目录作用                                                 |
| ------------------- | -------------------------------------------------------- |
| bin                 | 系统命令                                                 |
| sbin                | 系统管理员使用的命令                                     |
| home                | 普通用户的家目录(~)，每个用户一个目录                    |
| root                | 系统管理员目录                                           |
| lib                 | 动态连接库                                               |
| etc                 | 系统配置文件                                             |
| usr                 | 安装好的应用程序                                         |
| usr/local           | 通过编译原代码方式安装的程序                             |
| boot                | 系统启动引导文件                                         |
| proc                | 虚拟目录，系统内存映射，可以获取系统信息，不占用硬盘空间 |
| srv                 | service，服务启动后需要提取的数据                        |
| sys                 | 内核                                                     |
| tmp                 | 临时文件                                                 |
| dev                 | 硬件设备文件                                             |
| media               | U盘、光驱等外设文件                                      |
| mnt                 | 挂载的别的系统文件，远程文件夹，移动硬盘                 |
| opt                 | 原安装程序                                               |
| var                 | 日志文件，经常被修改的文件                               |
| selinux             | 安全子系统，被入侵时会留下痕迹                           |
| /etc/passwd         | 用户信息文件                                             |
| /etc/fastab         | 挂载信息文件                                             |
| /etc/redhat-release | 系统版本文件                                             |


## 1.4 命令行

### 1.4.1 命令行提示标识

​	

| #结尾 | 代表当前用户是超级管理员root |
| ----- | ---------------------------- |
| $结尾 | 代表当前用户是其他用户       |

```shell
命令行结构：[当前用户@主机名 当前目录]
```



### 1.4.2 命令行完整格式

```shell
命令  [选项]  [参数1] [参数2] ...
```



### 1.4.3 远程登陆

```shell
# 远程连接Linux需要开启SSHD服务
ssh -X 用户名@IP # -X 可以远程执行目标主机的界面程序
scp 目录 用户名@IP:目录 # 可以远程复制目录
```



# 2 Vi与Vim编辑器

```shell
# vim交互式文本编辑器，与sed（非交互式文本编辑器）不同
# vim可以看作是vi的增强版，编程时关键字变色，可代码补全
```



## 2.1 Vim三种常见模式

- 正常(命令)模式：可以使用快捷键

- 编辑模式：一般i键进入

- 命令行模式：可以完成相关指令，读取，存盘，替换等

  

## 2.2 正常模式部分命令

| 命令           | 作用                                 |
| -------------- | ------------------------------------ |
| yy             | 拷贝当前行                           |
| 5yy            | 拷贝当前向下5行（含本行）            |
| p              | 粘贴                                 |
| dd             | 删除当前行                           |
| 5dd            | 删除当前向下5行（含本行）            |
| /xxx           | 查找xxx，n向下切换光标位置           |
| :set nu        | 临时设置行号                         |
| :set nonu      | 取消行号                             |
| :%s /old/new/g | 替换所有，不加g，替换第一个匹配到的  |
| G              | 跳至文末                             |
| gg             | 跳至文首                             |
| u              | 撤销操作                             |
| 数字+G         | 移动至数字行                         |
| C              | 删除光标后的所有字符并进入编辑模式   |
| o              | 在光标的下一行插入空行并进入编辑模式 |
| ZZ             | 保存并退出                           |
| ZQ             | 不保存并退出                         |

# 3 关机、重启、内存备份操作命令

| 命令            | 作用                                   |
| --------------- | -------------------------------------- |
| shutdown -h now | 立即关机                               |
| shutdown -h 1   | 1分种后关机                            |
| shutdown -r now | 立即重启                               |
| poweroff        | 关机                                   |
| reboot          | 重启                                   |
| sync            | 内存数据存到磁盘，重启与关机前必须使用 |

# 4 用户操作

| 命令                   | 作用                                         |
| ---------------------- | -------------------------------------------- |
| useradd 用户名         | 添加用户                                     |
| useradd -d 目录 用户名 | 指定家目录（可不存在，不会自动创建）添加用户 |
| -g                     | 指定主组                                     |
| -G                     | 指定附加组                                   |
| -u                     | 指定uid                                      |
| -s                     | 指定默认解释器（默认为/bin/bash）            |
| passwd 用户名          | 设置/修改用户密码（需要root权限）            |
| userdel 用户名         | 删除用户                                     |
| userdel -r 用户名      | 删除用户及家目录（一般不要用）               |
| id 用户名 | 查询用户信息 uid：用户id gid：组id 组：所在组 |
| whoami | 显示当前用户 |
| su - 用户名 | 切换到用户，高权限到底权限不需要输入密码 |
| logout | 注销登陆，远程连接有效 |
```shell
echo 新密码 | passwd --stdin 用户  #直接修改密码
```



# 5 组操作

| 命令                   | 作用                 |
| ---------------------- | -------------------- |
| groupadd 组名          | 添加组               |
| groupdel 组名          | 删除组               |
| useradd -G 组名 用户名 | 创建用户时指定附加组 |
| usermod -G 组名 用户名 | 改变用户所在组       |


| 文件绝对路径 | 作用 |
| ----------- | ---- |
| /etc/passwd | 存用户信息 |
| /etc/group | 存组信息 |
| /etc/shadow | 存密码信息 |

```shell
#passwd的结构各部分作用
用户名:密码站位符:UID:GID:描述信息:家目录路径:解释器
```



## 5.1 组管理与权限管理

```shell
#用户至少属于一个组

chown 用户名 文件 #修改文件所有者,所在组不改变

-r 递归修改子目录与文件

chown :组名 文件 #修改文件所在组
```

```shell
#chmod 修改权限
#u 所有者 g 所在组 o 其他用户 a全部
chmod u=rwx,g=rx,o=r 文件/目录 #设置权限
chmod o+w 文件/目录 #o添加w权限
chmod o-w 文件/目录 #o减少w权限
```



# 6 Linux运行级别

| 运行级别 | 说明                         |
| -------- | ---------------------------- |
| 0        | 关机                         |
| 1        | 单用户（本地可修改root密码） |
| 2        | 多用户无网络                 |
| 3        | 多用户有网络                 |
| 4        | 无用                         |
| 5        | 图形界面                     |
| 6        | 重启                         |

```shell
#/etc/inittab 	运行级别文件
```



# 7 Linux内置命令

## 7.1 文件目录类指令

| 命令                                    | 作用                                                         |
| --------------------------------------- | ------------------------------------------------------------ |
| pwd                                     | 当前的绝对路径                                               |
| ls                                      | 显示目录下的文件                                             |
| ls -a                                   | 显示包括隐藏的所有文件和文件夹                               |
| ls -l                                   | 以列表形式显示详细信息，可以用ll                             |
| cd                                      | 切换目录                                                     |
| .                                       | 当前目录                                                     |
| ..                                      | 上级目录                                                     |
| mkdir                                   | 创建目录                                                     |
| mkdir -p                                | 创建多级目录                                                 |
| rmdir                                   | 删除空目录                                                   |
| rmdir -rf                               | 强制删除非空目录                                             |
| rm                                      | 删除文件 <br>-r 删除目录<br>-f 强制执行                      |
| touch                                   | 创建空文件                                                   |
| cp [选项] [源文件source] [目标目录dest] | 复制文件到新目录，-r 递归复制 文件夹<br>cp前面加\强制覆盖文件 |
| mv [选项] [源文件source] [目标目录dest] | 移动或重命名                                                 |
| cat                                     | 命令行界面打印文件内容<br>-n 显示行号                        |
| more                                    | 分页显示<br>enter 下一行<br>空格 下一页<br>ctrl f 下一页<br>ctrl b 上一页 |
| less                                    | 分页显示，按需加载，适合查看大文件，q退出                    |
| >                                       | 覆盖至文件                                                   |
| > >                                     | 追加至文件                                                   |
| head                                    | 查看文件前几行，默认10行<br/>-n 显示前n行                    |
| tail                                    | 查看文件后几行，默认10行<br>-n 显示后n行<br>-f 实时追踪文档的所有更新 |
| ln -s 源文件/目录 软连接名              | 创建软连接，没有选项是硬连接                                 |
| history                                 | 查看已经执行的命令历史                                       |
| ！数字                                  | 执行对应数字的历史命令                                       |
| tree                                    | 以树状图列出目录的内容                                       |
| wc 用于计算字数                         | -c 显示Bytes数<br>-m 统计所有字符个数                        |

### 软、硬连接

软连接可以跨分区，源可以是目录

硬连接不可以跨分区，源必须是文件

## 7.2 时间日期类

```shell
date #显示当前日期时间

date “+%Y %m %d %H %M %S” #以此格式显示年月日时分秒

date -S 字符串时间 #修改系统时间

cal #显示当月日历

cal 年份（数字） #显示此年日历
```



## 7.3 搜索查找类

| 格式               | 选项                                                         |
| ------------------ | ------------------------------------------------------------ |
| find [目录] [选项] | -name #名称为<br>-user #用户为<br/>-size +n #大于n的文件<br/>-size -n #小于n的文件<br/>-size n #大于等于n的文件<br/>-amin n #在过去 n 分钟内被读取过<br/>find递归查询目录下所有<br>--max-depth = n # 限制查询最大深度 |

```shell
locate #快速定位符合条件的文档
#使用locate前必须使用updatedb命令创建locate数据库
```

```shell
grep #过滤信息

-n #显示匹配行和行号

-i #忽略大小写
```

```shell
| #管道，将前面的结果传输给后面作为参数
```



## 7.4 压缩与解压缩类

| 命令   | 作用                                                         |
| ------ | ------------------------------------------------------------ |
| gzip   | 压缩，不保留源文件，生成.gz文件                              |
| gunzip | 解压,不保留源文件                                            |
| zip    | 压缩生存zip，-r 可压缩目录                                   |
| unzip  | 解压<br>-d 目录 # 指定压缩文件存放目录                       |
| tar    | 生成.tar文件<br>-c # 产生.tar文件<br>-v # 显示详细信息<br>-f # 制定压缩后的文件名,必须写此项<br>-z # 打包同时压缩生成.gz<br>-j # 打包同时压缩生成.bz2<br>-J # 打包同时压缩生成.xz<br>-x # 解压.tar文件<br>tar -zcvf xxx.tar.gz 目录 # 打包压缩指令<br>tar -zxvf xxx.tar.gz -C 目录(已存在) # 解压至指定目录 |

 

## 7.5 设置别名alias

```shell
alias 别名=‘命令’ # 设置别名
unalias 别名 # 取消别名
alias # 查看所有别名

~/.bashrc #别名永久设置,只此用户可使用。修改后重启终端生效
/etc/bashrc #别名永久设置,所有用户可使用。修改后重启终端生效
```



## 7.6 任务调度

```shell
crontab 定时任务管理
-e 设置定时任务
-r 清除当前用户所有定时任务
-l 查询定时任务

#格式
\* * * * * 任务 # 分 时 天 月 周 *代表每个整数 ,代表不连续的时间 -连续的时间 */n 每隔n时间
```



## 7.7 Linux 磁盘分区和挂载

```shell
mount /dev/sdb1  /home/mydisk # 临时挂载 重启失效	

umount # 卸载

lsblk -f 查看系统的分区与挂载情况

fdisk 硬盘目录 # 新建MBR分区 n 新建 p 打印 w 保存并退出。MBR支持最大2TB磁盘

mkfs.ext4 /dev/sdb1 # 格式化成ext4文件系统

vim /etc/fstab # 永久挂载,编辑内容

mount -a # 立刻执行自动挂载 可以检测配置文件是否写错
```


### 7.7.1 /etc/fstab配置文件含义

| 第一列         | 第二列 | 第三列       | 第四列 | 第五列                                               | 第六列                                                  |
| -------------- | ------ | ------------ | ------ | ---------------------------------------------------- | ------------------------------------------------------- |
| 设备UUID或目录 | 挂载点 | 文件系统格式 | 参数   | 是否备份<br>0 不备份<br>1 每天备份<br>2 不定日期备份 | 是否备份<br/>0 不备份<br/>1 每天备份<br/>2 不定日期备份 |

| df   | -h 以人类可读方式显示磁盘整体使用情况                        |
| ---- | ------------------------------------------------------------ |
| du   | -h 目录 # 查看目录占用磁盘情况<br>-s # 指定目录占用大小汇总<br>-a # 含文件<br>--max-depth = n # n为子目录深度<br>-c # 列出明细,并最后显示汇总 |

 



## 7.8 网络配置

### 7.8.1 yum配置

```shell
/etc/yum.repos.d/*.repo #配置文件路径与后缀
# 格式
[名字]
name = 描述信息
baseurl = url
enabled = 0 or 1  # 0 不可用，1 可用
gpgcheck = 0 or 1 # 0 不验证，1 验证
```

```shell
yum  repolist # 更新缓存列表

yum -y install 包名 # 安装包，自动安装依赖包

yum clean all # 清除所有缓存

yum remove 包名 # 依赖关系以下的都删除

createrepo "目录" # 生成yum仓库数据列表文件

yum provides 目录/文件 # 查看目录/文件由哪个软件提供

光盘挂载格式 iso9660
```



### 7.8.2 网关

```shell
/etc/resolv.conf # 网关文件

# 网关文件内容
nameserver xxx.xxx.xxx.xxx # xx为网关IP

route -n # 查看网关
```



### 7.8.3 永久修改ip

```shell
/etc/sysconfig/network-scripts/ifcfg-eth0  # 网卡配置文件

nmcli connection show #显示nmcli识别的网卡

nmcli connection modify '网卡名' ipv4.method manual ipv4.addresses 'xx.xx.xx.xx/24 xx.xx.xx.xx(网关)' ipv4.dns 'xx.xx.xx.xx' connection.autoconnect yes # 命令方式配置网卡

nmcli connection up '网卡名' # 生效配置
```



### 7.8.4 修改主机名

```shell
/etc/hostname # 主机名配置文件（默认不存在）

hostname # 查看主机名
hostname 主机名 # 临时设置主机名
```

# 8 常见端口

| http   | 80   |
| ------ | ---- |
| https  | 443  |
| ftp    | 21   |
| tftp   | 69   |
| DNS    | 53   |
| telnet | 23   |
| smtp   | 25   |
| pop3   | 110  |
| snmp   | 161  |

pop3：邮件协议3。规定怎样将个人计算机连接邮件服务器和下载的协议。

smtp：简单的邮件传输协议。从源地址到目的地址传输邮件的规范。

snmp：简单网络管理协议。包含一个应用层协议，数据库模型和一组资源对象。
